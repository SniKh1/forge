# 开发工作流规范

> **Purpose**: 定义任务分级、调研优先、Git 规范、上下文模式和 Vibe Coding 工作流。

---

## 一、调研优先（强制）

修改代码前必须：
1. **检索相关代码** - 使用 ace-tool / Task(Explore) / Grep / Glob
2. **识别复用机会** - 查找已有相似功能，优先复用而非重写
3. **追踪调用链** - 分析影响范围

### 1.1 修改前三问

1. 这是真问题还是臆想？（拒绝过度设计）
2. 有现成代码可复用吗？（优先复用）
3. 会破坏什么调用关系？（保护依赖链）

---

## 二、任务分级

| 级别 | 判断标准 | 处理方式 |
|------|----------|----------|
| 简单 | 单文件、明确需求、< 20 行改动 | 直接执行 |
| 中等 | 2-5 个文件、需要调研 | 简要说明方案 → 执行 |
| 复杂 | 架构变更、多模块、不确定性高 | 完整规划流程 |

### 2.1 复杂任务流程

1. **RESEARCH** - 调研代码，不提建议
2. **PLAN** - 列出方案，等待用户确认
3. **EXECUTE** - 严格按计划执行
4. **REVIEW** - 完成后自检

---

## 三、交互规范

### 3.1 何时询问用户

- 存在多个合理方案时
- 需求不明确或有歧义时
- 改动范围超出预期时
- 发现潜在风险时

### 3.2 何时直接执行

- 需求明确且方案唯一
- 小范围修改（< 20 行）
- 用户已确认过类似操作

---

## 四、Git 规范（强制）

### 4.1 基本规则

- 不主动提交，除非用户明确要求
- 不主动 push，除非用户明确要求
- 提交前：`git diff` 确认改动范围
- 禁止 `--force` 推送到 main/master

### 4.2 Commit 格式

```
<type>(<scope>): <description>
```

**类型**: feat, fix, refactor, docs, test, chore, perf, ci

---

## 五、上下文模式

| 模式 | 触发方式 | 行为特点 |
|------|----------|----------|
| dev | "进入开发模式" | 先写代码后解释，偏好可用方案 |
| review | "进入审查模式" | 彻底阅读，按严重性排序问题 |
| research | "进入研究模式" | 广泛阅读，先理解后行动 |

---

## 六、Vibe Coding 工作流

> **说需求 → 出代码 → 看效果 → 调整**

### 6.1 标准流程

```
1. 需求细化 → superpowers:brainstorm
2. 代码生成 → frontend-design / backend-development
3. 实时预览 → webapp-testing / browser
4. 效果检查 → chrome-devtools 截图
5. 快速调整 → 重复 2-4
6. 质量保障 → code-reviewer / tdd-guide
```

### 6.2 快速迭代原则

- **dev 模式**: 先能用，再正确，后整洁
- **小步快跑**: 每次改动尽量小
- **即时反馈**: 改完立即预览
- **自动修复**: 遇错用 debugging skill

---

## 七、环境设置

### 7.1 Windows / PowerShell

- PowerShell 不支持 `&&`，使用 `;` 分隔命令
- 中文路径用引号包裹
